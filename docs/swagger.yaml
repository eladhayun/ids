definitions:
  handlers.JobStatus:
    properties:
      active:
        type: integer
      completion_time:
        type: string
      failed:
        type: integer
      job_name:
        type: string
      start_time:
        type: string
      status:
        type: string
      succeeded:
        type: integer
    type: object
  handlers.TriggerEmailImportRequest:
    properties:
      source:
        description: 'Optional: specific source/path in blob storage'
        type: string
    type: object
  handlers.TriggerEmailImportResponse:
    properties:
      error:
        type: string
      job_name:
        type: string
      message:
        type: string
      success:
        type: boolean
    type: object
  models.ChatRequest:
    description: Chat request payload
    properties:
      conversation:
        description: Array of conversation messages
        items:
          $ref: '#/definitions/models.ConversationMessage'
        type: array
    type: object
  models.ChatResponse:
    description: Chat response payload
    properties:
      error:
        description: Error message if any
        example: ""
        type: string
      products:
        additionalProperties:
          type: string
        description: Product name to SKU mapping for link generation
        type: object
      response:
        description: AI response message
        example: Hello! How can I help you today?
        type: string
    type: object
  models.ConversationMessage:
    description: Single message in a conversation
    properties:
      message:
        description: Message content
        example: Hello, how can I help?
        type: string
      role:
        description: Message role (user, assistant, system)
        example: user
        type: string
    type: object
  models.DBHealthResponse:
    description: Database health check response
    properties:
      connected:
        description: Database connection status
        example: true
        type: boolean
      error:
        description: Error message if any
        example: ""
        type: string
      latency:
        description: Database ping latency
        example: 1ms
        type: string
      status:
        description: Health status
        example: healthy
        type: string
      timestamp:
        description: Timestamp of the check
        example: "2023-01-01T00:00:00Z"
        type: string
    type: object
  models.HealthResponse:
    description: Health check response
    properties:
      status:
        description: Health status
        example: healthy
        type: string
      timestamp:
        description: Timestamp of the check
        example: "2023-01-01T00:00:00Z"
        type: string
      version:
        description: Application version
        example: 1.0.0
        type: string
    type: object
info:
  contact: {}
paths:
  /api/:
    get:
      consumes:
      - application/json
      description: Get basic service information
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Root endpoint
      tags:
      - general
  /api/admin/email-import-status/{jobName}:
    get:
      consumes:
      - application/json
      description: Gets the current status of an email import job
      parameters:
      - description: Job name
        in: path
        name: jobName
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.JobStatus'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get email import job status
      tags:
      - admin
  /api/admin/trigger-email-import:
    post:
      consumes:
      - application/json
      description: Triggers a Kubernetes Job that downloads emails from Azure Blob
        Storage and imports them into the database
      parameters:
      - description: Import job parameters
        in: body
        name: request
        schema:
          $ref: '#/definitions/handlers.TriggerEmailImportRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.TriggerEmailImportResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handlers.TriggerEmailImportResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handlers.TriggerEmailImportResponse'
      summary: Trigger email import job
      tags:
      - admin
  /api/chat:
    post:
      consumes:
      - application/json
      description: Send a conversation to the AI chatbot and get a response with vector-based
        product recommendations
      parameters:
      - description: Chat request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.ChatRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.ChatResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ChatResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ChatResponse'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/models.ChatResponse'
      summary: Chat with AI using vector search
      tags:
      - chat
  /api/chat/enhanced:
    post:
      consumes:
      - application/json
      description: Send a conversation to the AI chatbot and get a response with product
        recommendations enhanced by similar past conversations
      parameters:
      - description: Chat request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.ChatRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.ChatResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ChatResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ChatResponse'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/models.ChatResponse'
      summary: Chat with AI using enhanced vector search (products + email history)
      tags:
      - chat
  /api/healthz:
    get:
      consumes:
      - application/json
      description: Get basic health status of the application
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.HealthResponse'
      summary: Health check
      tags:
      - health
  /api/healthz/db:
    get:
      consumes:
      - application/json
      description: Get database connectivity status and latency
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.DBHealthResponse'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/models.DBHealthResponse'
      summary: Database health check
      tags:
      - health
swagger: "2.0"
